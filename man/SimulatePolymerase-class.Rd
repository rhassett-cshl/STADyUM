% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_polymerase-class.R
\docType{class}
\name{SimulatePolymerase-class}
\alias{SimulatePolymerase-class}
\alias{simulatePolymerase}
\alias{sampleReadCountsPerNucleotide}
\alias{sampleGeneBodyAvgReadDensity}
\alias{show,SimulatePolymerase-method}
\alias{plotPolymeraseDistribution}
\alias{plotPauseSites}
\alias{plotTransitionProbabilities}
\alias{plotPositionMatrix}
\alias{savePlots}
\alias{plotAvgReadDensity}
\alias{pauseSites}
\alias{probabilityVector}
\alias{combinedCellsData}
\alias{positionMatrix}
\alias{parameters}
\alias{readCounts}
\alias{avgReadDensity}
\title{Constructor for SimulatePolymerase object}
\usage{
simulatePolymerase(
  k = 50,
  ksd = 25,
  kMin = 17,
  kMax = 200,
  geneLen = 1950,
  alpha = 1,
  beta = 1,
  zeta = 2000,
  zetaSd = 1000,
  zetaMin = 1500,
  zetaMax = 2500,
  zetaVec = NULL,
  cellNum = 1000,
  polSize = 33,
  addSpace = 17,
  time = 1,
  stepsToRecord = 1
)

sampleReadCountsPerNucleotide(object, readDensity = 0.0489)

sampleGeneBodyAvgReadDensity(object, readDensity = 0.0489)

\S4method{show}{SimulatePolymerase}(object)

plotPolymeraseDistribution(object, file = NULL, width = 8, height = 6)

plotPauseSites(object, file = NULL, width = 8, height = 6)

plotTransitionProbabilities(object, file = NULL, width = 8, height = 6)

plotPositionMatrix(object, file = NULL, width = 8, height = 6)

savePlots(object, dir = "results", width = 8, height = 6)

plotAvgReadDensity(object)

pauseSites(object)

probabilityVector(object)

combinedCellsData(object)

positionMatrix(object)

parameters(object)

readCounts(object)

avgReadDensity(object)
}
\arguments{
\item{k}{an integer value for the mean of pause sites across cells.}

\item{ksd}{a numeric value for the standard deviation of pause sites across
cells.}

\item{kMin}{an integer value for the upper bound of pause sites allowed.}

\item{kMax}{an integer value for the lower bound of pause sites allowed.}

\item{geneLen}{an integer value for the length of the gene.}

\item{alpha}{a numeric value for the initiation rate.}

\item{beta}{a numeric value for the pause release rate.}

\item{zeta}{a numeric value for the mean elongation rate across sites.}

\item{zetaSd}{a numeric value for the standard deviation of pause sites
across sites.}

\item{zetaMin}{a numeric value for the minimum elongation rate.}

\item{zetaMax}{a numeric value for the maximum elongation rate.}

\item{zetaVec}{a character value for the path to the zetaVec file.}

\item{cellNum}{an integer value for the number of cells to simulate.}

\item{polSize}{an integer value for the polymerase II size.}

\item{addSpace}{an integer value for the additional space in addition to
RNAP size.}

\item{time}{a numeric value for the time to simulate.}

\item{stepsToRecord}{an integer value for the number of steps to record in
position matrix.}

\item{object}{a \code{SimulatePolymerase-class} object}

\item{readDensity}{A numeric value for the read density within gene body in
\emph{Dukler et al.} (2017) for genes with median expression (i.e., 0.0489).}

\item{file}{Optional file path to save the plot}

\item{width}{Plot width in inches}

\item{height}{Plot height in inches}

\item{dir}{Directory to save the plots (default: "results")}
}
\value{
a \code{SimulatePolymerase} object

The read count per nucleotide value

The average read density within gene body

A ggplot object showing the distribution of polymerases across the
gene

A ggplot object showing the distribution of pause sites

A ggplot object showing the transition probabilities across the gene

A ggplot object showing the position matrix as a heatmap

Outputs directory where plots were saved to pdf files

A list containing all simulation parameters including k, ksd, kMin,
kMax, geneLen, alpha, beta, zeta, zetaSd, zetaMin, zetaMax, zetaVec, cellNum,
polSize, addSpace, time, and stepsToRecord
}
\description{
Class \code{SimulatePolymerase} tracks the movement of RNAPs along the DNA
templates. It contains the parameters for the simulator as well as the
simulator results including the position of RNAPs for the last step, the
pause sites, a probability vector containing probability RNAPs move forward
or not, and a combined cells data vector containing the total number of
RNAPs at each site across all cells

Runs the simulator that tracks the movement of RNAPs along the DNA
templates of a large number of cells. It accepts several key user-specified
parameters, including the initiation rate, pause-escape rate, a constant or
variable elongation rate, the mean and variance of pause sites across cells,
as well as the center-to-center spacing constraint between RNAPs, the number
of cells being simulated, the gene length, and the total time of
transcription. The simulator simply allows each RNAP to move forward or not,
in time slices of 1e-4 minutes, according to the specified position-specific
rate parameters. It assumes that at most one movement of each RNAP can occur
per time slice. The simulator monitors for collisions between adjacent
RNAPs, prohibiting one RNAP to advance if it is at the boundary of the
allowable distance from the next. After running for specified time, it
outputs the position of RNAPs for the last specified number of steps.

Sample read counts from a SimulatePolymerase object. To match our simulated
read counts to reality, we need to compute a scaling factor lambda. One way
of doing it is computing the read density based on real experiments. For
example, we have computed the read density within gene body in
\emph{Dukler et al} (2017) for genes with median expression (i.e., 0.0489).
If we assume the read counts following a Poisson distribution, we can then
sample the read counts with mean equals to the RNAP frequency multiplied by
lambda.

Sample the average read density within gene body from a SimulatePolymerase
object.

Show method for SimulatePolymerase object in human readable format
including summary statistics

Plot the distribution of polymerases across the gene.

Plot the distribution of pause sites across the gene.

Plot the transition probabilities across the gene.

Plot the position matrix as a heatmap.

Save all plots to files.

Plot the average read density within gene body from a SimulatePolymerase
object.

Accessor for the pause sites numeric vector from a SimulatePolymerase object.

Accessor for the probability numeric vector from a SimulatePolymerase object.

Accessor for the combined cells data numeric vector from a
SimulatePolymerase object.

Accessor for the position matrix from a SimulatePolymerase object.

Accessor for the simulation parameters from a SimulatePolymerase object.

Accessor for the read counts numeric vector sampled from a
SimulatePolymerase object.

Accessor for the average read density numeric vector sampledfrom a
SimulatePolymerase object.
}
\section{Slots}{

\describe{
\item{\code{k}}{an integer value for the mean of pause sites across cells.}

\item{\code{ksd}}{a numeric value for the standard deviation of pause sites across
cells.}

\item{\code{kMin}}{an integer value for the upper bound of pause sites allowed.}

\item{\code{kMax}}{an integer value for the lower bound of pause sites allowed.}

\item{\code{geneLen}}{an integer value for the length of the gene.}

\item{\code{alpha}}{a numeric value for the initiation rate.}

\item{\code{beta}}{a numeric value for the pause release rate.}

\item{\code{zeta}}{a numeric value for the mean elongation rate across sites.}

\item{\code{zetaSd}}{a numeric value for the standard deviation of pause sites
across sites.}

\item{\code{zetaMin}}{a numeric value for the minimum elongation rate.}

\item{\code{zetaMax}}{a numeric value for the maximum elongation rate.}

\item{\code{zetaVec}}{a character value for the path to the zetaVec file.}

\item{\code{cellNum}}{an integer value for the number of cells to simulate.}

\item{\code{polSize}}{an integer value for the polymerase II size.}

\item{\code{addSpace}}{an integer value for the additional space in addition to
RNAP size.}

\item{\code{time}}{a numeric value for the time to simulate.}

\item{\code{deltaT}}{a numeric value for the time step size in the simulation.}

\item{\code{stepsToRecord}}{an integer value for the number of steps to record in
position matrix.}

\item{\code{pauseSites}}{a numeric vector of pause sites}

\item{\code{probabilityVector}}{a numeric vector representing the probability that
the polymerase move forward or not at each site}

\item{\code{combinedCellsData}}{an integer vector representing the total number of
RNAPs at each site across all cells}

\item{\code{positionMatrix}}{a matrix of position of polymerase}

\item{\code{readCounts}}{a numeric vector for read counts per nucleotide}

\item{\code{avgReadDensity}}{a numeric vector for average read density}
}}

\examples{
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Print the object
print(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Sample read counts per nucleotide
readCounts <- sampleReadCountsPerNucleotide(sim)
# Print the read counts per nucleotide
print(readCounts)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1) 
# Sample average read density within gene body
avgReadDensity <- sampleGeneBodyAvgReadDensity(sim)
# Print the average read density within gene body
print(avgReadDensity)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Show the object
show(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Plot polymerase distribution
plotPolymeraseDistribution(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1) 
# Plot pause site distribution
plotPauseSites(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Plot transition probabilities
plotTransitionProbabilities(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Plot position matrix
plotPositionMatrix(sim)

# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Save plots
savePlots(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Plot average read density
plotAvgReadDensity(sim)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get pause sites
pauseSites <- pauseSites(sim)
# Print the pause sites
print(pauseSites)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get probability vector
probabilityVector <- probabilityVector(sim)
# Print the probability vector
print(probabilityVector)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get combined cells data
combinedCellsData <- combinedCellsData(sim)
# Print the combined cells data
print(combinedCellsData)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get position matrix
positionMatrix <- positionMatrix(sim)
# Print the position matrix
print(positionMatrix)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get parameters
parameters <- parameters(sim)
# Print the parameters
print(parameters)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get read counts    
readCounts <- readCounts(sim)
# Print the read counts
print(readCounts)
# Create a SimulatePolymerase object
sim <- SimulatePolymerase(
    k=50, ksd=25, kMin=17, kMax=200, geneLen=1950,
    alpha=1, beta=1, zeta=2000, zetaSd=1000, zetaMin=1500, zetaMax=2500,
    zetaVec=NULL, cellNum=1000, polSize=33, addSpace=17, time=1, 
    stepsToRecord=1)
# Get average read density
avgReadDensity <- avgReadDensity(sim)
# Print the average read density
print(avgReadDensity)
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/experiment_transcription_rates-class.R
\docType{class}
\name{ExperimentTranscriptionRates-class}
\alias{ExperimentTranscriptionRates-class}
\alias{estimateTranscriptionRates,character-method}
\alias{plotRates}
\alias{rates,ExperimentTranscriptionRates-method}
\alias{counts}
\alias{pauseRegions}
\alias{geneBodyRegions}
\alias{omegaScale}
\alias{stericHindrance,ExperimentTranscriptionRates-method}
\alias{plotMeanPauseDistrib}
\alias{plotExpectedVsObservedPauseSites}
\alias{plotChiDistrib}
\alias{plotBetaVsChi}
\alias{plotPauseSiteContourMap}
\title{Constructor for ExperimentTranscriptionRates object}
\usage{
\S4method{estimateTranscriptionRates}{character}(
  x,
  bigwigMinus,
  pauseRegions,
  geneBodyRegions,
  stericHindrance = FALSE,
  omegaScale = NULL,
  ...
)

plotRates(
  object,
  type = "scatter",
  rateType = "betaAdp",
  file = NULL,
  width = 8,
  height = 6,
  dpi = 300,
  ...
)

\S4method{rates}{ExperimentTranscriptionRates}(object)

counts(object)

pauseRegions(object)

geneBodyRegions(object)

omegaScale(object)

\S4method{stericHindrance}{ExperimentTranscriptionRates}(object)

plotMeanPauseDistrib(object, file = NULL, width = 8, height = 6, dpi = 300)

plotExpectedVsObservedPauseSites(
  object,
  file = NULL,
  width = 8,
  height = 6,
  dpi = 300
)

plotChiDistrib(object, file = NULL, width = 8, height = 6, dpi = 300)

plotBetaVsChi(
  object,
  beta_type = "betaAdp",
  file = NULL,
  width = 8,
  height = 6,
  dpi = 300
)

plotPauseSiteContourMap(object, file = NULL, width = 8, height = 6, dpi = 300)
}
\arguments{
\item{x}{The path to a bigwig file from the plus strand recording PRO-seq
read counts}

\item{bigwigMinus}{the path to a bigwig file from the minus strand recording
PRO-seq read counts}

\item{pauseRegions}{a \link[GenomicRanges]{GRanges-class} object that must
contain a gene_id}

\item{geneBodyRegions}{a \link[GenomicRanges]{GRanges-class} object that
must contain a gene_id}

\item{stericHindrance}{a logical value to determine whether to infer
landing-pad occupancy or not. Defaults to FALSE.}

\item{omegaScale}{a numeric value for scaling omega. Defaults to NULL.}

\item{...}{Additional arguments passed to the plotting function}

\item{object}{an \code{\link{ExperimentTranscriptionRates}} object}

\item{type}{Type of plot to create ("scatter", "histogram", or "density").
Defaults to "scatter"}

\item{rateType}{Which rate to plot ("betaOrg", "betaAdp", "chi", etc.).
Defaults to "betaAdp"}

\item{file}{the path to a file to save the plot to}

\item{width}{the width of the plot in inches}

\item{height}{the height of the plot in inches}

\item{dpi}{the resolution of the plot in dpi}

\item{beta_type}{the type of beta to plot. Can be "betaAdp" for the adapted
model or "betaOrg" for the single pause site model. Defaults to "betaAdp".}
}
\value{
an \code{\link{ExperimentTranscriptionRates-class}} object

A ggplot object

a \code{DataFrame} with the following columns:
\item{geneId}{a character vector of gene IDs}
\item{chi}{a numeric vector of RNAP density along gene body}
\item{betaOrg}{a numeric vector }
\item{betaAdp}{a numeric vector }
\item{fkMean}{a numeric vector of the mean position of pause sites}
\item{fkVar}{a numeric vector of the variance of pause site positions}
\item{phi}{a numeric vector of the landing-pad occupancy}
\item{betaZeta}{a numeric vector of the pause-escape rate}
\item{alphaZeta}{a numeric vector of the potential initiation rate}
\item{omega}{a numeric vector of the effective initiation rate}
\item{omegaZeta}{a numeric vector of the effective initiation rate}

a \code{DataFrame} with the following columns:
\item{geneId}{a character vector of gene IDs}
\item{summarizedGbCounts}{a numeric vector of the sum of gene body read
counts}
\item{gbLength}{a numeric vector of the gene body length}
\item{summarizedPauseCounts}{a numeric vector of the sum of pause region
read counts}

a \link[GenomicRanges]{GRanges-class} object with the pause regions

a \link[GenomicRanges]{GRanges-class} object with the gene body
regions

a numeric value for the scaling factor for omega

a logical value to determine whether to infer landing-pad occupancy
or not

an \code{\link{ggplot2}} object

an \code{\link{ggplot2}} object

an \code{\link{ggplot2}} object

an \code{\link{ggplot2}} object

an \code{\link{ggplot2}} object
}
\description{
Class \code{ExperimentTranscriptionRates} has read counts, pause and gene
body genomic region coordinates, steric hindrance and omega scale factor
parameters used to estimate the transcription rates as well as the estimated
rates

Estimates the transcription rates using Expectation Maximization likelihood
formula. Estimates initiation, pause-release rates, average read depth along
gene body and pause regions. If steric hindrance is enabled, also estimates
the landing pad occupancy. Estimated from experimental data, such as nascent
RNA sequencing read counts and genomic coordinates, and contructs an object
that holds these rates. Considers models where pause sites are fixed or
varied. Considers models where steric hindrance is enabled or disabled.

Plots the transcription rates using ggplot2.

Accessor for the estimated rates

Accessor for the read counts

Accessor for the pause region coords \link[GenomicRanges]{GRanges-class}

Accessor for the gene body regions coords \link[GenomicRanges]{GRanges-class}

Accessor for the omega scale used to scale the omega value based on prior
studies.

Accessor for the steric hindrance flag. If TRUE, the landing-pad
occupancy is inferred in the rates held in this object.

Creates a histogram plot showing the distribution of observed mean pause site
positions across all genes. This visualization helps identify the range and
shape of pause site positions

Creates a scatter plot comparing observed pause site counts (Xk) against
expected pause site counts (Yk) from the EM algorithm. This visualization
assesses the goodness-of-fit of the pause site model by showing how well
the model predictions align with the actual data. A perfect fit would show
all points on the diagonal line (y=x). The RÂ² value is calculated and
displayed on the plot to quantify the model fit quality. This plot is
useful for validating the accuracy of the pause site estimation and
identifying any systematic biases in the model predictions.

Creates a density plot showing the distribution of gene body RNAP density
(chi) across all genes. This visualization helps identify the range and
shape of RNA polymerase density in gene bodies, which can reveal patterns in
transcriptional activity.

Plot a scatter plot with gene body RNAP density on the x-axis and beta (ratio
of gene body RNAP density to pause region RNAP density) on the y-axis. Fits a
linear model to the data and plots the line. Can plot beta for either the
adapted model or the single pause site model.

Plot a contour map with mean pause site position on the x-axis and pause site
variance on the y-axis.
}
\section{Slots}{

\describe{
\item{\code{counts}}{a \code{data.frame} with five columns gene_id,
summarizedPauseCounts, pauseLength, summarizedGbCounts, gbLength}

\item{\code{bigwigPlus}}{a path to bigwig for plus strand recording PRO-seq read
counts. This can be generated with the proseq2.0 pipeline.}

\item{\code{bigwigMinus}}{a path to bigwig for minus strand recording PRO-seq read
counts. This can be generated with the proseq2.0 pipeline.}

\item{\code{pauseRegions}}{a \code{\link[GenomicRanges]{GRanges-class}} object that
holds the pause regions coordinates}

\item{\code{geneBodyRegions}}{a \code{\link[GenomicRanges]{GRanges-class}} object
that holds the gene body regions coordinates}

\item{\code{stericHindrance}}{a logical value indicating whether to infer
landing-pad occupancy}

\item{\code{omegaScale}}{a numeric value for scaling omega, or NULL if steric
hindrance is disabled}

\item{\code{rates}}{a \code{\link[tibble]{tbl_df}} containing the estimated rates
with columns:
\describe{
\item{geneId}{Character. Gene identifier}
\item{chi}{Numeric. RNAP density along gene body given as estimate for the
gene body elongation rate \link{RNAPs/bp}}
\item{betaOrg}{Numeric. Ratio of gene body RNAP density to pause region
RNAP density with fixed pause sites given as an estimate for the
pause-escape rate}
\item{betaAdp}{Numeric. Ratio of gene body RNAP density to pause region
RNAP density from adapted model which allows pause sites to vary across
cells given as an estimate for the pause-escape rate}
\item{fkMean}{Numeric. Mean position of pause sites}
\item{fkVar}{Numeric. Variance of pause site positions}
\item{phi}{Numeric. Landing-pad occupancy (only if steric hindrance is
enabled)}
\item{betaZeta}{Numeric. Pause-escape rate (only if steric hindrance is
enabled)}
\item{alphaZeta}{Numeric. Potential initiation rate (only if steric
hindrance is enabled)}
\item{omegaZeta}{Numeric. Effective initiation rate (only if steric
hindrance is enabled)}
\item{totalGbRc}{Numeric. Total gene body read counts}
\item{gbLength}{Numeric. Gene body length}
\item{Yk}{Numeric. Expected pause site counts}
\item{Xk}{Numeric. Observed pause site counts}
}}
}}

\examples{
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
    stericHindrance = TRUE,
    omegaScale = 1000,
)

# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
)

# Plot rates as a histogram
plotRates(expRates, type = "histogram")
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
)

# Get the rates from the object
rates(expRates)
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
)
pauseRegions(expRates)
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
)
geneBodyRegions(expRates)
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
)
omegaScale(expRates)
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
)
stericHindrance(expRates)
# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
    stericHindrance = TRUE,
    omegaScale = 1000,
)
plotMeanPauseDistrib(expRates, file="mean_pause_distrib.png")

# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
    stericHindrance = TRUE,
    omegaScale = 1000,
)
plotExpectedVsObservedPauseSites(expRates,
file="expected_vs_observed_pause_sites.png")

# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
    stericHindrance = TRUE,
    omegaScale = 1000,
)
plotChiDistrib(expRates, file="chi_distrib.png")

# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
    stericHindrance = TRUE,
    omegaScale = 1000,
)
plotBetaVsChi(expRates, beta_type = "betaAdp", file="beta_vs_chi.png")

# Create an ExperimentTranscriptionRates object
load("inst/extdata/granges_for_read_counting_chr21_subset.RData")
expRates <- estimateTranscriptionRates(
    "inst/extdata/PROseq-K562-vihervaara-control-SE_plus_chr21_subset.bw",
    bigwigMinus = 
     "inst/extdata/PROseq-K562-vihervaara-control-SE_minus_chr21_subset.bw",
    pauseRegions = bw_pause_21_subset,
    geneBodyRegions = bw_gene_body_21_subset,
    stericHindrance = TRUE,
    omegaScale = 1000,
)
plotPauseSiteContourMap(expRates, file="pause_sites_contour_map.png")

}
